<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sistem Enkripsi PDF AES-256 Web3</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container">
      <!-- Header dengan tema Web3 -->
      <header class="header">
        <div class="logo">
          <i class="fas fa-shield-alt"></i>
          <h1>PDF<span class="gradient-text">AES-256</span></h1>
        </div>
        <div class="tagline">
          <p>Enkripsi & Dekripsi PDF Tingkat Militer</p>
          <div class="network-status">
            <span class="status-dot active"></span>
            <span>Sistem Online</span>
          </div>
        </div>
      </header>

      <main class="main-content">
        <!-- Navigation Tabs -->
        <div class="tabs">
          <button class="tab-btn active" data-tab="execution">
            <i class="fas fa-play-circle"></i> Eksekusi
          </button>
          <button class="tab-btn" data-tab="process">
            <i class="fas fa-cogs"></i> Alur Proses
          </button>
          <button class="tab-btn" data-tab="guide">
            <i class="fas fa-book"></i> Panduan
          </button>
        </div>

        <!-- Execution Tab -->
        <div class="tab-content active" id="execution-tab">
          <div class="card">
            <div class="card-header">
              <h2><i class="fas fa-terminal"></i> Antarmuka Perintah</h2>
              <div class="card-badge">SESI AKTIF</div>
            </div>

            <div class="upload-area" id="uploadArea">
              <i class="fas fa-cloud-upload-alt upload-icon"></i>
              <h3>Seret & Lepas File PDF</h3>
              <p>atau klik untuk memilih (Maks. 16MB)</p>
              <input type="file" id="fileInput" accept=".pdf,.aes256" hidden />
              <button class="btn-outline" id="browseBtn">
                <i class="fas fa-folder-open"></i> Pilih File
              </button>
              <div class="file-info" id="fileInfo"></div>
            </div>

            <div class="form-group">
              <label for="password">
                <i class="fas fa-key"></i> Kunci Enkripsi
              </label>
              <div class="input-with-icon">
                <input
                  type="password"
                  id="password"
                  placeholder="Masukkan password (min. 4 karakter)"
                />
                <button
                  type="button"
                  id="togglePassword"
                  class="icon-btn"
                  title="Tampilkan/sembunyikan password"
                >
                  <i class="fas fa-eye"></i>
                </button>
              </div>
              <div class="password-strength" id="passwordStrength">
                <div class="strength-bar"></div>
                <span class="strength-text">Kekuatan Password: Kosong</span>
              </div>
            </div>

            <div class="action-buttons">
              <button
                class="btn-encrypt"
                id="encryptBtn"
                title="Unggah file PDF untuk mengenkripsi"
              >
                <i class="fas fa-lock"></i> Enkripsi PDF
                <div class="btn-glow"></div>
              </button>
              <button
                class="btn-decrypt"
                id="decryptBtn"
                title="Unggah file .aes256 untuk mendekripsi"
              >
                <i class="fas fa-unlock"></i> Dekripsi PDF
                <div class="btn-glow"></div>
              </button>
            </div>

            <div
              class="process-animation"
              id="processAnimation"
              style="display: none"
            >
              <div class="animation-container">
                <div class="crypto-node"></div>
                <div class="crypto-node"></div>
                <div class="crypto-node"></div>
                <div class="wave"></div>
                <p>Memproses dengan AES-256-CBC...</p>
              </div>
            </div>

            <div
              class="result-container"
              id="resultContainer"
              style="display: none"
            >
              <div class="result-success">
                <i class="fas fa-check-circle"></i>
                <h3 id="resultMessage">Operasi Berhasil!</h3>
                <button class="btn-download" id="downloadBtn">
                  <i class="fas fa-download"></i> Unduh File
                </button>
              </div>
            </div>
          </div>

          <div class="info-grid">
            <div class="info-card">
              <i class="fas fa-microchip"></i>
              <h4>Enkripsi AES-256</h4>
              <p>Algoritma enkripsi tingkat militer</p>
            </div>
            <div class="info-card">
              <i class="fas fa-layer-group"></i>
              <h4>Transformasi XOR</h4>
              <p>Lapisan keamanan tambahan</p>
            </div>
            <div class="info-card">
              <i class="fas fa-shield-halved"></i>
              <h4>Zero-Knowledge</h4>
              <p>File diproses secara lokal</p>
            </div>
          </div>
        </div>

        <!-- Process Flow Tab -->
        <div class="tab-content" id="process-tab">
          <div class="card">
            <div class="card-header">
              <h2>
                <i class="fas fa-project-diagram"></i> Alur Proses Kriptografi
              </h2>
            </div>

            <div class="process-flow">
              <div class="flow-step">
                <div class="step-number">1</div>
                <div class="step-content">
                  <h3>Unggah PDF</h3>
                  <p>Sistem membaca data biner dari file PDF yang diunggah</p>
                </div>
                <div class="step-icon">
                  <i class="fas fa-file-upload"></i>
                </div>
              </div>

              <div class="flow-arrow">
                <i class="fas fa-arrow-down"></i>
              </div>

              <div class="flow-step">
                <div class="step-number">2</div>
                <div class="step-content">
                  <h3>Transformasi XOR</h3>
                  <p>
                    Transformasi XOR berbasis password diterapkan ke data biner
                  </p>
                  <code>data âŠ• byte_password</code>
                </div>
                <div class="step-icon">
                  <i class="fas fa-random"></i>
                </div>
              </div>

              <div class="flow-arrow">
                <i class="fas fa-arrow-down"></i>
              </div>

              <div class="flow-step">
                <div class="step-number">3</div>
                <div class="step-content">
                  <h3>Derivasi Kunci</h3>
                  <p>
                    Password dikonversi menjadi kunci 256-bit menggunakan PBKDF2
                  </p>
                  <code>PBKDF2(password, salt, 100000 iterasi)</code>
                </div>
                <div class="step-icon">
                  <i class="fas fa-key"></i>
                </div>
              </div>

              <div class="flow-arrow">
                <i class="fas fa-arrow-down"></i>
              </div>

              <div class="flow-step">
                <div class="step-number">4</div>
                <div class="step-content">
                  <h3>Enkripsi AES-256-CBC</h3>
                  <p>Data dienkripsi dengan AES-256 dalam mode CBC</p>
                  <code>IV + AES-256-CBC(data)</code>
                </div>
                <div class="step-icon">
                  <i class="fas fa-lock"></i>
                </div>
              </div>

              <div class="flow-arrow">
                <i class="fas fa-arrow-down"></i>
              </div>

              <div class="flow-step">
                <div class="step-number">5</div>
                <div class="step-content">
                  <h3>Header Keamanan</h3>
                  <p>
                    File terenkripsi ditambahkan header khusus untuk
                    identifikasi
                  </p>
                  <code>header + salt + data_terenkripsi</code>
                </div>
                <div class="step-icon">
                  <i class="fas fa-code"></i>
                </div>
              </div>

              <div class="flow-arrow">
                <i class="fas fa-arrow-down"></i>
              </div>

              <div class="flow-step">
                <div class="step-number">6</div>
                <div class="step-content">
                  <h3>Unduh</h3>
                  <p>File terenkripsi siap diunduh dengan ekstensi .aes256</p>
                </div>
                <div class="step-icon">
                  <i class="fas fa-download"></i>
                </div>
              </div>
            </div>

            <div class="note-box">
              <i class="fas fa-info-circle"></i>
              <p>
                <strong>Proses Dekripsi:</strong> Alur terbalik dimulai dari
                verifikasi header, dekripsi AES, transformasi XOR terbalik
              </p>
            </div>
          </div>
        </div>

        <!-- User Guide Tab -->
        <div class="tab-content" id="guide-tab">
          <div class="card">
            <div class="card-header">
              <h2>
                <i class="fas fa-graduation-cap"></i> Panduan Pengguna &
                Dokumentasi
              </h2>
            </div>

            <div class="guide-section">
              <h3><i class="fas fa-play"></i> Memulai</h3>
              <ol class="guide-list">
                <li>Navigasi ke tab <strong>Eksekusi</strong></li>
                <li>Unggah file PDF Anda (seret & lepas atau klik pilih)</li>
                <li>Masukkan password yang kuat (minimal 4 karakter)</li>
                <li>
                  Pilih antara <strong>Enkripsi</strong> atau
                  <strong>Dekripsi</strong>
                </li>
                <li>Unduh file yang telah diproses</li>
              </ol>
            </div>

            <div class="guide-section">
              <h3><i class="fas fa-lock"></i> Proses Enkripsi</h3>
              <div class="guide-card">
                <h4>ðŸ“Œ Yang Terjadi Selama Enkripsi:</h4>
                <ul>
                  <li>Data biner PDF mengalami transformasi XOR</li>
                  <li>Password dikonversi menjadi kunci enkripsi 256-bit</li>
                  <li>Data dienkripsi dengan algoritma AES-256-CBC</li>
                  <li>Salt dan IV dihasilkan untuk keamanan tambahan</li>
                  <li>Hasil ditambahkan header khusus untuk identifikasi</li>
                </ul>
              </div>
            </div>

            <div class="guide-section">
              <h3><i class="fas fa-unlock"></i> Proses Dekripsi</h3>
              <div class="guide-card">
                <h4>ðŸ“Œ Persyaratan Dekripsi Berhasil:</h4>
                <ul>
                  <li>
                    <strong>Password yang sama persis</strong> dengan saat
                    enkripsi
                  </li>
                  <li>
                    File harus dalam format .aes256 (dienkripsi oleh sistem ini)
                  </li>
                  <li>Integritas file harus terjaga (tidak ada modifikasi)</li>
                </ul>
                <p class="warning">
                  <i class="fas fa-exclamation-triangle"></i> Password yang
                  hilang tidak dapat dipulihkan. Sistem tidak menyimpan password
                  apa pun.
                </p>
              </div>
            </div>

            <div class="guide-section">
              <h3><i class="fas fa-shield-alt"></i> Fitur Keamanan</h3>
              <div class="feature-grid">
                <div class="feature">
                  <i class="fas fa-fingerprint"></i>
                  <h5>Kunci Berbasis Password</h5>
                  <p>Kunci 256-bit diturunkan dari password Anda</p>
                </div>
                <div class="feature">
                  <i class="fas fa-sync-alt"></i>
                  <h5>Lapisan XOR</h5>
                  <p>Transformasi tambahan sebelum AES</p>
                </div>
                <div class="feature">
                  <i class="fas fa-user-secret"></i>
                  <h5>Tidak Ada Penyimpanan Data</h5>
                  <p>File diproses di memori, tidak disimpan</p>
                </div>
                <div class="feature">
                  <i class="fas fa-bug"></i>
                  <h5>Deteksi Manipulasi</h5>
                  <p>Password/file tidak valid memicu error</p>
                </div>
              </div>
            </div>

            <div class="guide-section">
              <h3><i class="fas fa-question-circle"></i> FAQ</h3>
              <div class="faq-item">
                <h4>Q: Apa perbedaan dengan sistem enkripsi lain?</h4>
                <p>
                  A: Sistem ini menggunakan kombinasi XOR + AES-256 dengan
                  header khusus, membuatnya lebih aman dan hanya dapat
                  didekripsi oleh sistem ini.
                </p>
              </div>
              <div class="faq-item">
                <h4>Q: Apakah file saya aman?</h4>
                <p>
                  A: Ya, file diproses di server dan langsung dihapus setelah
                  diunduh. Tidak ada penyimpanan permanen.
                </p>
              </div>
              <div class="faq-item">
                <h4>Q: Berapa ukuran file maksimal?</h4>
                <p>A: Maksimal 16MB untuk menjaga kinerja sistem.</p>
              </div>
            </div>
          </div>
        </div>
      </main>

      <!-- Footer -->
      <footer class="footer">
        <div class="footer-content">
          <div class="footer-section">
            <h4><i class="fas fa-database"></i> Status Sistem</h4>
            <div class="status-item">
              <span class="status-indicator active"></span>
              <span>Mesin AES-256</span>
            </div>
            <div class="status-item">
              <span class="status-indicator active"></span>
              <span>Prosesor XOR</span>
            </div>
            <div class="status-item">
              <span class="status-indicator active"></span>
              <span>Penangan File</span>
            </div>
          </div>

          <div class="footer-section">
            <h4><i class="fas fa-info-circle"></i> Informasi Cepat</h4>
            <p>Ukuran file maksimal: 16MB</p>
            <p>Format yang didukung: PDF & .aes256</p>
            <p>Enkripsi: AES-256-CBC</p>
          </div>

          <div class="footer-section">
            <h4><i class="fas fa-exclamation-triangle"></i> Penafian</h4>
            <p class="disclaimer">
              Alat ini hanya untuk penggunaan pribadi dan bisnis yang sah.
              Pengembang tidak bertanggung jawab atas penyalahgunaan perangkat
              lunak ini.
            </p>
          </div>
        </div>
        <!-- Tambahkan di bagian footer, sebelum footer-bottom -->
        <div class="footer-section">
          <h4><i class="fas fa-code"></i> Demo Kriptografi</h4>
          <button class="btn-code" id="showCodeBtn" title="Lihat demo enkripsi">
            <i class="fas fa-laptop-code"></i> Demo Proses Enkripsi
          </button>
          <p class="demo-info">
            Lihat logika enkripsi bekerja langsung di browser
          </p>
        </div>

        <!-- Tambahkan modal untuk menampilkan visualisasi enkripsi -->
        <div class="code-modal" id="codeModal">
          <div class="modal-content">
            <div class="modal-header">
              <h2>
                <i class="fas fa-laptop-code"></i> Demo Visualisasi Enkripsi
                AES-256
              </h2>
              <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="modal-body">
              <!-- Tab untuk pilih mode -->
              <div class="demo-tabs">
                <button class="demo-tab active" data-demo="encrypt">
                  Proses Enkripsi
                </button>
                <button class="demo-tab" data-demo="decrypt">
                  Proses Dekripsi
                </button>
                <button class="demo-tab" data-demo="code">Kode Python</button>
              </div>

              <!-- Kontainer untuk demo enkripsi -->
              <div class="demo-container active" id="encryptDemo">
                <div class="demo-step">
                  <div class="step-header">
                    <span class="step-number">1</span>
                    <h3>Input Data & Password</h3>
                  </div>
                  <div class="step-content">
                    <div class="data-display">
                      <div class="data-box">
                        <h4>Data PDF (Hex Preview):</h4>
                        <div class="hex-data" id="originalData">
                          25 50 44 46 2D 31 2E 34 0A 25 25 45 4F 46 0A
                        </div>
                        <div class="data-info">
                          <span class="data-label">Header PDF: </span>
                          <span class="data-value">%PDF-1.4</span>
                        </div>
                      </div>
                      <div class="data-box">
                        <h4>Password:</h4>
                        <div class="password-display">
                          <input
                            type="text"
                            id="demoPassword"
                            value="MySecret123!"
                            placeholder="Masukkan password demo"
                          />
                          <button class="btn-small" id="generateDemo">
                            Generate Data
                          </button>
                        </div>
                        <div class="data-info">
                          <span class="data-label">Hash SHA-256: </span>
                          <span class="data-value" id="passwordHash">...</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="demo-step">
                  <div class="step-header">
                    <span class="step-number">2</span>
                    <h3>Transformasi XOR</h3>
                  </div>
                  <div class="step-content">
                    <div class="algorithm-display">
                      <div class="algorithm-formula">
                        <code>data âŠ• hash(password)</code>
                      </div>
                      <div class="process-visual">
                        <div class="process-item">
                          <div class="process-label">Data Asli</div>
                          <div class="hex-block" id="originalHex">
                            25 50 44 46
                          </div>
                        </div>
                        <div class="process-operator">âŠ•</div>
                        <div class="process-item">
                          <div class="process-label">Hash Password</div>
                          <div class="hex-block" id="passwordHex">
                            A1 B2 C3 D4
                          </div>
                        </div>
                        <div class="process-operator">=</div>
                        <div class="process-item">
                          <div class="process-label">Hasil XOR</div>
                          <div class="hex-block result" id="xorResult">
                            84 E2 87 92
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="demo-step">
                  <div class="step-header">
                    <span class="step-number">3</span>
                    <h3>Derivasi Kunci (PBKDF2)</h3>
                  </div>
                  <div class="step-content">
                    <div class="key-derivation">
                      <div class="derivation-formula">
                        <code
                          >PBKDF2(password, salt, 100000 iterations,
                          SHA-256)</code
                        >
                      </div>
                      <div class="key-components">
                        <div class="component">
                          <div class="component-label">Salt (16 bytes):</div>
                          <div class="hex-block small" id="demoSalt">
                            S1 A2 L3 T4 56 78 90 AB
                          </div>
                        </div>
                        <div class="component">
                          <div class="component-label">
                            Kunci AES-256 (32 bytes):
                          </div>
                          <div class="hex-block small" id="demoKey">
                            K1 E2 Y3 00 FF 11 22 33...
                          </div>
                        </div>
                        <div class="component">
                          <div class="component-label">IV (16 bytes):</div>
                          <div class="hex-block small" id="demoIV">
                            I1 V2 00 99 AA BB CC DD
                          </div>
                        </div>
                      </div>
                      <div class="derivation-info">
                        <i class="fas fa-info-circle"></i>
                        <span
                          >100,000 iterasi memperlambat brute-force attack</span
                        >
                      </div>
                    </div>
                  </div>
                </div>

                <div class="demo-step">
                  <div class="step-header">
                    <span class="step-number">4</span>
                    <h3>Enkripsi AES-256-CBC</h3>
                  </div>
                  <div class="step-content">
                    <div class="encryption-visual">
                      <div class="cbc-diagram">
                        <div class="cbc-block">
                          <div class="block-header">Blok 1</div>
                          <div class="block-content">
                            <div class="block-input">
                              <span>XOR Data</span>
                              <div class="hex-tiny">84 E2 87 92</div>
                            </div>
                            <div class="block-operator">âŠ•</div>
                            <div class="block-iv">
                              <span>IV</span>
                              <div class="hex-tiny" id="blockIV">
                                I1 V2 00 99
                              </div>
                            </div>
                            <div class="block-arrow">â†“</div>
                            <div class="block-aes">
                              <div class="aes-label">AES-256</div>
                              <div class="aes-icon">
                                <i class="fas fa-lock"></i>
                              </div>
                            </div>
                            <div class="block-arrow">â†“</div>
                            <div class="block-output">
                              <span>Ciphertext</span>
                              <div class="hex-tiny result" id="cipherBlock1">
                                C1 P1 H1 E2
                              </div>
                            </div>
                          </div>
                        </div>

                        <div class="cbc-connector">
                          <i class="fas fa-arrow-down"></i>
                          <span>Digunakan untuk blok berikutnya</span>
                        </div>

                        <div class="cbc-block">
                          <div class="block-header">Blok 2</div>
                          <div class="block-content">
                            <div class="block-input">
                              <span>XOR Data</span>
                              <div class="hex-tiny">...</div>
                            </div>
                            <div class="block-operator">âŠ•</div>
                            <div class="block-iv">
                              <span>Blok 1</span>
                              <div class="hex-tiny">C1 P1 H1 E2</div>
                            </div>
                            <div class="block-arrow">â†“</div>
                            <div class="block-aes">
                              <div class="aes-label">AES-256</div>
                              <div class="aes-icon">
                                <i class="fas fa-lock"></i>
                              </div>
                            </div>
                            <div class="block-arrow">â†“</div>
                            <div class="block-output">
                              <span>Ciphertext</span>
                              <div class="hex-tiny result">C2 P2 H2 E3</div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="demo-step">
                  <div class="step-header">
                    <span class="step-number">5</span>
                    <h3>Hasil Akhir (.aes256)</h3>
                  </div>
                  <div class="step-content">
                    <div class="final-output">
                      <div class="file-structure">
                        <div class="structure-item header">
                          <div class="structure-label">Header (16 bytes)</div>
                          <div class="structure-data">
                            50 44 46 41 45 53 32 35 36
                          </div>
                          <div class="structure-info">"PDFAES256" + random</div>
                        </div>
                        <div class="structure-item salt">
                          <div class="structure-label">Salt (16 bytes)</div>
                          <div class="structure-data" id="finalSalt">
                            S1 A2 L3 T4 56 78 90 AB
                          </div>
                          <div class="structure-info">Untuk derivasi kunci</div>
                        </div>
                        <div class="structure-item iv">
                          <div class="structure-label">IV (16 bytes)</div>
                          <div class="structure-data" id="finalIV">
                            I1 V2 00 99 AA BB CC DD
                          </div>
                          <div class="structure-info">
                            Initialization Vector
                          </div>
                        </div>
                        <div class="structure-item cipher">
                          <div class="structure-label">
                            Ciphertext (N bytes)
                          </div>
                          <div class="structure-data" id="finalCipher">
                            C1 P1 H1 E2 C2 P2 H2 E3
                          </div>
                          <div class="structure-info">Data terenkripsi</div>
                        </div>
                      </div>
                      <div class="file-info">
                        <i class="fas fa-file"></i>
                        <span
                          >File output: document.pdf â†’
                          document_encrypted.aes256</span
                        >
                      </div>
                    </div>
                  </div>
                </div>

                <div class="demo-controls">
                  <button class="btn-play" id="playDemo">
                    <i class="fas fa-play"></i> Jalankan Demo Langkah demi
                    Langkah
                  </button>
                  <button class="btn-reset" id="resetDemo">
                    <i class="fas fa-redo"></i> Reset Demo
                  </button>
                </div>
              </div>

              <!-- Kontainer untuk demo dekripsi -->
              <div class="demo-container" id="decryptDemo">
                <div class="demo-step">
                  <div class="step-header">
                    <span class="step-number">1</span>
                    <h3>Input File .aes256</h3>
                  </div>
                  <div class="step-content">
                    <div class="data-display">
                      <div class="data-box">
                        <h4>File .aes256:</h4>
                        <div class="file-structure small">
                          <div class="structure-item header">
                            <div class="structure-label">Header</div>
                            <div class="structure-data">
                              50 44 46 41 45 53 32 35 36
                            </div>
                          </div>
                          <div class="structure-item salt">
                            <div class="structure-label">Salt</div>
                            <div class="structure-data">
                              S1 A2 L3 T4 56 78 90 AB
                            </div>
                          </div>
                          <div class="structure-item iv">
                            <div class="structure-label">IV</div>
                            <div class="structure-data">
                              I1 V2 00 99 AA BB CC DD
                            </div>
                          </div>
                          <div class="structure-item cipher">
                            <div class="structure-label">Ciphertext</div>
                            <div class="structure-data">
                              C1 P1 H1 E2 C2 P2 H2 E3
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="data-box">
                        <h4>Password untuk Dekripsi:</h4>
                        <div class="password-display">
                          <input
                            type="text"
                            id="decryptPassword"
                            value="MySecret123!"
                            placeholder="Masukkan password"
                          />
                        </div>
                        <div class="validation-status" id="validationStatus">
                          <i class="fas fa-check-circle valid"></i>
                          <span>Password valid</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="demo-step">
                  <div class="step-header">
                    <span class="step-number">2</span>
                    <h3>Verifikasi & Ekstraksi</h3>
                  </div>
                  <div class="step-content">
                    <div class="verification-process">
                      <div class="verification-step">
                        <div class="verification-icon">
                          <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="verification-content">
                          <h4>Verifikasi Header</h4>
                          <p>Memastikan file dienkripsi oleh sistem ini</p>
                          <code>if header == "PDFAES256": continue</code>
                        </div>
                      </div>
                      <div class="verification-step">
                        <div class="verification-icon">
                          <i class="fas fa-download"></i>
                        </div>
                        <div class="verification-content">
                          <h4>Ekstraksi Komponen</h4>
                          <p>Mengambil salt, IV, dan ciphertext</p>
                          <code>salt = data[16:32], iv = data[32:48]</code>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="demo-step">
                  <div class="step-header">
                    <span class="step-number">3</span>
                    <h3>Dekripsi AES-256-CBC</h3>
                  </div>
                  <div class="step-content">
                    <div class="decryption-visual">
                      <div class="cbc-diagram reverse">
                        <div class="cbc-block">
                          <div class="block-header">Blok 1</div>
                          <div class="block-content">
                            <div class="block-input">
                              <span>Ciphertext</span>
                              <div class="hex-tiny">C1 P1 H1 E2</div>
                            </div>
                            <div class="block-arrow">â†“</div>
                            <div class="block-aes">
                              <div class="aes-label">AES-256</div>
                              <div class="aes-icon">
                                <i class="fas fa-unlock"></i>
                              </div>
                            </div>
                            <div class="block-arrow">â†“</div>
                            <div class="block-output">
                              <div class="block-operator">âŠ•</div>
                              <div class="block-iv">
                                <span>IV</span>
                                <div class="hex-tiny">I1 V2 00 99</div>
                              </div>
                              <div class="block-result">
                                <span>XOR Data</span>
                                <div class="hex-tiny result">84 E2 87 92</div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="demo-step">
                  <div class="step-header">
                    <span class="step-number">4</span>
                    <h3>Reverse XOR Transformation</h3>
                  </div>
                  <div class="step-content">
                    <div class="reverse-xor">
                      <div class="process-visual">
                        <div class="process-item">
                          <div class="process-label">XOR Data</div>
                          <div class="hex-block">84 E2 87 92</div>
                        </div>
                        <div class="process-operator">âŠ•</div>
                        <div class="process-item">
                          <div class="process-label">Hash Password</div>
                          <div class="hex-block">A1 B2 C3 D4</div>
                        </div>
                        <div class="process-operator">=</div>
                        <div class="process-item">
                          <div class="process-label">Data Asli</div>
                          <div class="hex-block result">25 50 44 46</div>
                        </div>
                      </div>
                      <div class="formula-info">
                        <code>original_data = xor_data âŠ• hash(password)</code>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="demo-step">
                  <div class="step-header">
                    <span class="step-number">5</span>
                    <h3>Verifikasi PDF & Output</h3>
                  </div>
                  <div class="step-content">
                    <div class="final-verification">
                      <div class="verification-check">
                        <div class="check-item valid">
                          <i class="fas fa-check"></i>
                          <span>Signature PDF: %PDF- (valid)</span>
                        </div>
                        <div class="check-item valid">
                          <i class="fas fa-check"></i>
                          <span>Struktur file: OK</span>
                        </div>
                        <div class="check-item valid">
                          <i class="fas fa-check"></i>
                          <span>Ukuran file: Konsisten</span>
                        </div>
                      </div>
                      <div class="output-preview">
                        <div class="preview-box">
                          <h4>Hasil Dekripsi:</h4>
                          <div class="hex-data" id="decryptedData">
                            25 50 44 46 2D 31 2E 34 0A 25 25 45 4F 46 0A
                          </div>
                          <div class="preview-info">
                            <i class="fas fa-file-pdf"></i>
                            <span>document.pdf (PDF versi 1.4)</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Kontainer untuk menampilkan kode Python -->
              <div class="demo-container" id="codeDemo">
                <div class="code-viewer">
                  <div class="code-header">
                    <h3><i class="fab fa-python"></i> Implementasi Python</h3>
                    <div class="code-tabs">
                      <button class="code-tab active" data-code="encrypt">
                        encrypt_pdf()
                      </button>
                      <button class="code-tab" data-code="decrypt">
                        decrypt_pdf()
                      </button>
                      <button class="code-tab" data-code="utils">
                        Fungsi Utilitas
                      </button>
                    </div>
                  </div>

                  <div class="code-content active" id="encryptCode">
                    <pre><code class="python">def encrypt_pdf(file_data, password):
    """Encrypt PDF using AES-256-CBC with XOR layer"""
    try:
        # 1. Generate random salt (16 bytes)
        salt = get_random_bytes(16)
        
        # 2. Derive key and IV from password using PBKDF2
        key, iv = derive_key_and_iv(password, salt)
        
        # 3. First XOR transformation with password hash
        password_hash = hashlib.sha256(password.encode()).digest()
        xor_data = xor_transform(file_data, password_hash)
        
        # 4. Create AES cipher in CBC mode
        cipher = AES.new(key, AES.MODE_CBC, iv)
        
        # 5. Pad data to AES block size (16 bytes)
        padded_data = pad(xor_data, AES.block_size)
        
        # 6. Encrypt the data
        encrypted_data = cipher.encrypt(padded_data)
        
        # 7. Create security header (16 bytes total)
        header = b'PDFAES256' + get_random_bytes(7)
        
        # 8. Combine all components
        final_data = header + salt + encrypted_data
        
        return final_data
        
    except Exception as e:
        raise ValueError(f"Encryption error: {str(e)}")</code></pre>
                  </div>

                  <div class="code-content" id="decryptCode">
                    <pre><code class="python">def decrypt_pdf(encrypted_data, password):
    """Decrypt PDF that was encrypted with encrypt_pdf"""
    try:
        # 1. Check minimum file size
        if len(encrypted_data) < 48:
            raise ValueError("File too small or corrupted")
        
        # 2. Verify header (first 9 bytes should be PDFAES256)
        if not encrypted_data[:9] == b'PDFAES256':
            raise ValueError("Invalid encrypted file format")
        
        # 3. Extract components
        header = encrypted_data[:16]      # 16 bytes header
        salt = encrypted_data[16:32]       # 16 bytes salt
        encrypted_payload = encrypted_data[32:]  # Encrypted data
        
        # 4. Check encrypted payload size
        if len(encrypted_payload) < 16:
            raise ValueError("File corrupted or too small")
        
        # 5. The first 16 bytes of payload is IV
        iv = encrypted_payload[:16]
        ciphertext = encrypted_payload[16:]
        
        # 6. Derive key and IV from password
        key, derived_iv = derive_key_and_iv(password, salt)
        
        # 7. Create cipher and decrypt
        cipher = AES.new(key, AES.MODE_CBC, iv)
        decrypted_padded = cipher.decrypt(ciphertext)
        
        # 8. Remove padding
        xor_data = unpad(decrypted_padded, AES.block_size)
        
        # 9. Reverse XOR transformation
        password_hash = hashlib.sha256(password.encode()).digest()
        original_data = xor_transform(xor_data, password_hash)
        
        # 10. Verify PDF signature
        if not is_valid_pdf(original_data):
            raise ValueError("Invalid password or corrupted file")
        
        return original_data
        
    except Exception as e:
        raise ValueError(f"Decryption failed: {str(e)}")</code></pre>
                  </div>

                  <div class="code-content" id="utilsCode">
                    <pre><code class="python">def derive_key_and_iv(password, salt):
    """Derive key and IV from password using PBKDF2"""
    # PBKDF2 with 100,000 iterations producing 48 bytes
    key_iv = hashlib.pbkdf2_hmac(
        'sha256',           # Hash function
        password.encode(),  # Password as bytes
        salt,               # Random salt
        100000,             # Iterations (slows brute-force)
        dklen=48            # Output length: 32 + 16
    )
    key = key_iv[:32]  # 32 bytes for AES-256 key
    iv = key_iv[32:]   # 16 bytes for IV
    return key, iv

def xor_transform(data, key):
    """XOR transformation with expanded key"""
    # Repeat key to match data length
    key_bytes = key * (len(data) // len(key) + 1)
    
    # XOR each byte
    transformed = bytearray()
    for i, byte in enumerate(data):
        transformed.append(byte ^ key_bytes[i % len(key_bytes)])
    
    return bytes(transformed)

def is_valid_pdf(file_data):
    """Check if data is a valid PDF"""
    # Check multiple PDF signatures
    signatures = [
        b'%PDF-',  # Standard PDF
        b'%PDF ',  # Alternative
        b'%PDF1',  # PDF version
    ]
    
    for sig in signatures:
        if file_data.startswith(sig):
            return True
    
    # Also check if PDF appears in first 1000 bytes
    if b'%PDF' in file_data[:1000]:
        return True
    
    return False</code></pre>
                  </div>
                </div>

                <div class="code-explanation">
                  <h4><i class="fas fa-lightbulb"></i> Penjelasan Kunci:</h4>
                  <ul class="explanation-list">
                    <li>
                      <strong>PBKDF2</strong>: Slow key derivation untuk
                      mencegah brute-force
                    </li>
                    <li>
                      <strong>Salt</strong>: Random 16-byte mencegah rainbow
                      table attacks
                    </li>
                    <li>
                      <strong>IV</strong>: Random untuk setiap enkripsi,
                      mencegah pattern analysis
                    </li>
                    <li>
                      <strong>XOR Layer</strong>: Tambahan keamanan sebelum AES
                    </li>
                    <li>
                      <strong>CBC Mode</strong>: Setiap blok tergantung blok
                      sebelumnya
                    </li>
                    <li>
                      <strong>Header Verification</strong>: Memastikan file dari
                      sistem ini
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="footer-bottom">
          <p>Â© 2024 Sistem Enkripsi PDF AES-256 Web3 | Indra Maha Resi</p>
          <div class="footer-links">
            <a
              href="https://github.com/IndraMahaResi/PDF-AES256-ENCRYPT"
              title="GitHub"
              ><i class="fab fa-github"></i
            ></a>
            <a href="#" title="Kode"><i class="fas fa-code"></i></a>
            <a href="#" title="Keamanan"><i class="fas fa-shield-alt"></i></a>
          </div>
        </div>
      </footer>
    </div>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
  </body>
</html>
